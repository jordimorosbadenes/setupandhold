---
import BaseLayout from '../layouts/BaseLayout.astro';
import PostCard from '../components/PostCard.astro';
import { getCollection } from 'astro:content';

const allPosts = (await getCollection('blog', ({ data }) => !data.draft)).sort(
  (a, b) => b.data.date.valueOf() - a.data.date.valueOf()
);
const latest = allPosts.slice(0, 6);
const base = import.meta.env.BASE_URL || '/';
---
<BaseLayout title="setupandhold" description="Notas cortas sobre software y datos.">
  <section class="hero">
    <div>
      <p class="pill">Blog en Astro · listo para GitHub Pages</p>
      <h1>Setup & Hold</h1>
      <p>
        Bitácora ligera para documentar ideas, experimentos y proyectos. Pensada
        para crecer con posts en Markdown y publicar directo en GitHub Pages.
      </p>
    </div>
    <div class="hero-actions">
      <a class="button" href={`${base}posts`}>Leer el blog</a>
      <a class="button" href={`${base}puzzle`} rel="prefetch">Puzzle Generator</a>
      <a class="button secondary" href="https://github.com" target="_blank" rel="noreferrer">Repositorio</a>
    </div>
  </section>

  <div class="section-title">
    <h2>Entradas recientes</h2>
    <a class="button secondary" href={`${base}posts`}>Ver todas</a>
  </div>
  <div class="post-grid">
    {latest.map((post) => <PostCard post={post} />)}
  </div>
</BaseLayout>
